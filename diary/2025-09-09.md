# 2025年9月9日 作業ログ

## 概要

プロジェクトの初期設定と、Next.jsによるウェブサイトの環境構築、及びNotion APIと連携した基本的な記事一覧表示機能の実装を行った。

## 本日の作業内容

### 1. プロジェクト初期設定

- `git init` を実行して、Gitリポジトリを初期化。
- 今後の作業ログを記録するために `diary` フォルダを作成。

### 2. 開発方針の決定

- Notionをバックエンドとしたウェブサイトを構築する方針を固めた。
- 以下の技術スタックを提案し、合意を得た。
    - **フレームワーク:** Next.js (React)
    - **Notion連携:** Notion SDK (`@notionhq/client`)
    - **スタイリング:** Tailwind CSS

### 3. Next.js 環境構築

- `npx create-next-app` を使用して、TypeScript, Tailwind CSS, ESLint を導入したNext.jsプロジェクトを作成。

### 4. プロジェクトのクリーンアップ

- `create-next-app` によって生成された不要なサンプルファイルを削除・編集。

### 5. Notion API 連携と一覧表示機能の実装

- ユーザーから提供されたAPIキーとDBのIDを `.env.local` に設定。
- Notionからデータを取得し、トップページに表示する処理を実装。
- この過程で、以下の課題が発生し、解決した。
    - **課題1: `notion.databases.query is not a function` エラー**
        - **原因:** `npm` の依存関係解決に問題があり、`@notionhq/client` の不正なバージョン (`5.0.0`) がインストールされていた。親ディレクトリの `package-lock.json` が影響している可能性が高かった。
        - **解決策:** 親ディレクトリのロックファイルを削除し、`node_modules`, `package-lock.json`, `npm cache` を全てクリアして依存関係を再構築。それでも解決しなかったため、最終的に `@notionhq/client` の使用を断念し、`fetch` APIで直接Notion APIを呼び出す方式に変更して問題を回避した。
    - **課題2: タイトルが「タイトルなし」と表示される**
        - **原因:** プログラム側で仮定していたタイトルプロパティ名 (`Name`) と、実際のプロパティ名 (`タイトル`) が異なっていた。
        - **解決策:** ユーザーにプロパティ名を確認し、コード (`page.tsx`) を修正した。
    - **課題3: Notion APIからのエラーレスポンス**
        - **原因:** `公開状態` プロパティ (ステータス型) に対するフィルターの記述が、セレクト型用の記述になっていたため。
        - **解決策:** ユーザーにプロパティの型を確認し、「ステータス」型用の正しいフィルター条件に修正した。

### 6. 動的コンテンツ表示の実装

- `公開状態` が `公開済み` の記事のみをフィルタリングして取得。
- `コンテンツタイプ` プロパティの値で記事をグループ化。
- グループごと見出しを付けて、記事のタイトルを一覧表示する機能を実装完了。

### 7. デザインの適用とデバッグ

- ユーザーから提供されたHTMLを元に、サイト全体のデザインを適用した。
    - `Header`, `Footer` コンポーネントを作成し、共通レイアウト (`layout.tsx`) に配置。
    - `next/font/google` を使用してカスタムフォント (`Inter`, `Gothic A1`) を読み込む設定を追加。
    - `tailwind.config.ts` を作成し、カスタムフォントを登録。
    - トップページ (`page.tsx`) を提供されたHTMLレイアウトに沿って再構築。Notionから取得した動的データをカードレイアウトに組み込んだ。
- **課題4: `Module not found` エラー**
    - **原因:** Next.jsの開発サーバー `Turbopack` と、`next/font` で読み込んだ `Gothic_A1` フォントとの間に互換性の問題があった。
    - **解決策:** `package.json` の `dev` スクリプトから `--turbopack` フラグを削除し、標準のWebpackベースの開発サーバーに切り替えることで問題を解決した。